# Updates for CRoPS to ICAPS

## Parametric & Functional
The parameters controlling the structure of the swarm have changed to be able to suit dynamic obstacles. There is a smaller distance threshold used when determining when an obstacle will have any influence over a robot. This has been added to limit the influence from a large amount of obstacles that would not allow the robot to move. For instance if two dynamic obstacles are moving towards the robot, it would be possible for them to not allow the robot to move even if there exists a possible configuration for the robot to enter. To make sure that there is still suitable influence on the robots from the obstacles, we have increased the scaling factor for the repulsive potential. This ensures that when the robot comes too close to the obstacle, there will be an adequate amount of force to repel it. The function used to govern the repulsive potential from obstacles has also changed. The new function is now f(b1, b2) = const / sqrt(dist(b1, b2)). With this change, the potential increases more rapidly and therefore makes the function more reactive.

## Algorithmic
The robots now no longer perform random walks upon getting into a stuck configuration. Instead, a new path is determined using the pre-existing roadmap that will hopefully steer the robot out of the stuck configuration. Once the robot enters a stuck configuration (i.e. the robot has not moved enough over a given time interval) the weight of the 3 next nodes on the current path is increased on the roadmap and the shortest path is redetermined using this edited roadmap. The starting point for the shortest path algorithm changes every time the robot get stuck. The starting point is chosen by determining the closest node on the roadmap to the current boid. This ensures that the same path is not chosen each time the robot gets stuck. Since we are dealing with dynamic obstacles that may obstruct the global path, the new path determination decreases the overall wait time due to path branching. Since a robot is determined to be stuck due to a lack of movement, when the swarm reaches a obstacle bottle neck, new paths will be chosen by individual robots that will try to avoid the bottle neck. This branches the current path and limits the influence of the bottle neck. Also, since the obstacles are dynamic and will obstruct the current path, determining new routes will decrease the overall weight time and will limit the total number of robots that will reach an unrecoverable configuration.

## Discussion
Since there are guarding obstacles that can obstruct narrow passageways on the given path, the time between the first and last robot reaching the goal will vary greatly. This time depends on the configuration and velocities of the dynamic obstacles and on the number of robots in the swarm. The swarm is likely to be broken up into sub swarms at each guarding obstacle. It is possible to instruct the swarm to wait on its neighbors but that is not effective in decreasing the overall time needed per robot to reach the goal. Since there are many robots in the swarm, the fact that they break into sub-swarms does not mean that they are not acting cohesively since the sub-swarms will be large. 

When interpreting the results of the differential goal entrance time (difference in time from each robot entering the last goal), the spikes indicate when a sub-swarm was formed due to a guarding obstacle. These spikes are not a flaw of the algorithm but rather, a design measure. Using potential fields, the robots will wait until the passage is open in order to proceed. The robots will enter a stuck configuration and will construct a new path that will branch around the guarding robot. With this information, the theoretical spacing between spikes in the differential graph should be near the amount of time steps that a robot has to remain stationary to be considered stuck. However, this is not achieved in practice because the roadmap may not in every case, be complete enough for a totally new collision free path to be determined.